<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Flappy Bird JS</title>
    <style>
        body { margin: 0; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; background: #70c5ce; }
        canvas { border: 2px solid #000; background: #70c5ce; }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="320" height="480"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Spiel-Variablen
let birdY = 200;
let birdX = 50;
let velocity = 0;
let gravity = 0.25;
let score = 0;
let gameRunning = true;

const pipes = [];
const pipeWidth = 50;
const pipeGap = 120;

// Steuerung: Leertaste oder Klick
const flap = () => { if(gameRunning) velocity = -5; else location.reload(); };
document.addEventListener("keydown", (e) => { if(e.code === "Space") flap(); });
canvas.addEventListener("mousedown", flap);

function createPipe() {
    const pipeTopHeight = Math.random() * (canvas.height - pipeGap - 100) + 50;
    pipes.push({ x: canvas.width, top: pipeTopHeight });
}

function update() {
    if (!gameRunning) return;

    velocity += gravity;
    birdY += velocity;

    // Rohre bewegen
    if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 150) createPipe();

    for (let i = pipes.length - 1; i >= 0; i--) {
        pipes[i].x -= 2;

        // Kollisionsprüfung
        if (birdX + 20 > pipes[i].x && birdX < pipes[i].x + pipeWidth) {
            if (birdY < pipes[i].top || birdY + 20 > pipes[i].top + pipeGap) {
                gameRunning = false;
            }
        }

        // Punktzahl
        if (pipes[i].x === birdX) score++;

        // Rohr entfernen, wenn aus dem Bild
        if (pipes[i].x + pipeWidth < 0) pipes.splice(i, 1);
    }

    // Boden/Decke Kollision
    if (birdY + 20 > canvas.height || birdY < 0) gameRunning = false;
}

function draw() {
    // Hintergrund löschen
    ctx.fillStyle = "#70c5ce";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Vogel zeichnen
    ctx.fillStyle = "yellow";
    ctx.fillRect(birdX, birdY, 20, 20);

    // Rohre zeichnen
    ctx.fillStyle = "green";
    pipes.forEach(p => {
        ctx.fillRect(p.x, 0, pipeWidth, p.top); // Oben
        ctx.fillRect(p.x, p.top + pipeGap, pipeWidth, canvas.height); // Unten
    });

    // Score zeichnen
    ctx.fillStyle = "white";
    ctx.font = "24px Arial";
    ctx.fillText(`Score: ${score}`, 10, 30);

    if (!gameRunning) {
        ctx.fillText("GAME OVER", 90, 240);
        ctx.font = "16px Arial";
        ctx.fillText("Klick zum Neustart", 95, 270);
    }
}

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
